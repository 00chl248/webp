<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>My Place & Comments</title>
  <link rel="stylesheet" href="../ST_place_css/style.css" />
  <script src="https://developers.kakao.com/sdk/js/kakao.js"></script>
  <script>
    Kakao.init('7b0b8007e60a8f79ca197b522ecc0040');
  </script>
</head>
<body>
  <!-- ìƒë‹¨ ë°” -->
  <div class="navbar">
    <div class="navbar-inner">
      <div class="logo">
        <a href="main.html"><img src="im01.png" alt="ë¡œê³ " /></a>
      </div>
      <div class="category-icon" onclick="toggleSidebar()">â˜°</div>
    </div>
  </div>

  <!-- ì‚¬ì´ë“œë°” -->
  <div class="sidebar" id="sidebar">
    <div class="sidebar-close" onclick="toggleSidebar()">âœ•</div>
    <button class="login-button" id="loginBtn">íšŒì›ê°€ì… / ë¡œê·¸ì¸</button>
    <ul>
      <li>My Place & Comments</li>
      <li onclick="location.href='suggest.html'">ê±´ì˜ì‚¬í•­</li>
      <li id="withdrawBtn" style="display: none; color: gray;">íšŒì›íƒˆí‡´</li>
    </ul>
  </div>

  <!-- ë©”ì¸ ì½˜í…ì¸  -->
  <div class="main-content">
    <h2 class="page-title">ğŸ“ My Place & Comments</h2>

    <!-- My Places -->
    <div class="section-box">
      <div class="section-title">My Places</div>
      <div id="myPlacesContainer" class="card-scroll-container">
        <!-- ì¹´ë“œê°€ JSë¡œ ì¶”ê°€ë¨ -->
      </div>
    </div>

    <!-- My Comments -->
    <div class="section-box">
      <div class="section-title">My Comments</div>
      <div class="placeholder">ì•„ì§ ì‘ì„±í•œ ì„¼í…ìŠ¤ê°€ ì—†ìŠµë‹ˆë‹¤.</div>
    </div>
  </div>

 <script>
  function toggleSidebar() {
    const sidebar = document.getElementById('sidebar');
    sidebar.classList.toggle('active');
  }

  window.addEventListener('click', function (e) {
    const sidebar = document.getElementById('sidebar');
    const icon = document.querySelector('.category-icon');
    if (sidebar.classList.contains('active') &&
        !sidebar.contains(e.target) &&
        !icon.contains(e.target)) {
      sidebar.classList.remove('active');
    }
  });

  function loginWithKakao() {
    Kakao.Auth.login({
      success: function () {
        Kakao.API.request({
          url: '/v2/user/me',
          success: function () {
            document.getElementById('loginBtn').textContent = 'ë¡œê·¸ì•„ì›ƒ';
            document.getElementById('loginBtn').onclick = logoutFromKakao;
            document.getElementById('withdrawBtn').style.display = 'block';
          }
        });
      },
      fail: function (err) {
        alert('ë¡œê·¸ì¸ ì‹¤íŒ¨: ' + JSON.stringify(err));
      }
    });
  }

  function logoutFromKakao() {
    Kakao.Auth.logout(function () {
      document.getElementById('loginBtn').textContent = 'íšŒì›ê°€ì… / ë¡œê·¸ì¸';
      document.getElementById('loginBtn').onclick = loginWithKakao;
      document.getElementById('withdrawBtn').style.display = 'none';
    });
  }

  document.addEventListener('DOMContentLoaded', function () {
    const loginBtn = document.getElementById('loginBtn');
    const withdrawBtn = document.getElementById('withdrawBtn');
    loginBtn.onclick = loginWithKakao;
    withdrawBtn.onclick = function () {
      alert('íšŒì›íƒˆí‡´ëŠ” ê³ ê°ì„¼í„°ë¥¼ í†µí•´ ì²˜ë¦¬ë©ë‹ˆë‹¤.');
    };

    // í…ŒìŠ¤íŠ¸ì˜¤ã…›ã…‡
    fetch('../places/places.json')
  .then(res => {
    if (!res.ok) throw new Error('JSON íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŒ');
    return res.json();
  })
  .then(data => {
    const container = document.getElementById('myPlacesContainer');

    if (!data || data.length === 0) {
      container.innerHTML = '<p class="placeholder">ì €ì¥ëœ ì¥ì†Œê°€ ì—†ìŠµë‹ˆë‹¤.</p>';
    } else {
      data.forEach(place => {
  const card = document.createElement('div');
  card.className = 'card';
  card.innerHTML = `
    <img src="../places/${place.image}" alt="${place.name}" />
    <h3>${place.name}</h3>
    <p>${place.desc}</p>
  `;
  container.appendChild(card);
});

    }
  })
  .catch(err => {
    console.error('ì¥ì†Œ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤:', err);
  });


    /*
    // âœ… ì›ë˜ëŠ” localStorageì—ì„œ ì°œí•œ ì¥ì†Œë§Œ ê°€ì ¸ì˜¤ëŠ” ì½”ë“œ
    const myPlaces = JSON.parse(localStorage.getItem('myPlaces')) || [];
    const container = document.getElementById('myPlacesContainer');

    if (myPlaces.length === 0) {
      container.innerHTML = '<p class="placeholder">ì €ì¥ëœ ì¥ì†Œê°€ ì—†ìŠµë‹ˆë‹¤.</p>';
    } else {
      myPlaces.forEach(place => {
        const card = document.createElement('div');
        card.className = 'card';
        card.innerHTML = `
          <img src="../place_images/${place.image}" alt="${place.name}" />
          <h3>${place.name}</h3>
          <p>${place.description}</p>
        `;
        container.appendChild(card);
      });
    }
    */
  });
</script>
